// src/lib/colors.js
export const tailwindColors = [
	// Slate
	{ name: 'slate-50', hex: '#f8fafc' },
	{ name: 'slate-100', hex: '#f1f5f9' },
	{ name: 'slate-200', hex: '#e2e8f0' },
	{ name: 'slate-300', hex: '#cbd5e1' },
	{ name: 'slate-400', hex: '#94a3b8' },
	{ name: 'slate-500', hex: '#64748b' },
	{ name: 'slate-600', hex: '#475569' },
	{ name: 'slate-700', hex: '#334155' },
	{ name: 'slate-800', hex: '#1e293b' },
	{ name: 'slate-900', hex: '#0f172a' },
	{ name: 'slate-950', hex: '#020617' },
	// Gray
	{ name: 'gray-50', hex: '#f9fafb' },
	{ name: 'gray-100', hex: '#f3f4f6' },
	{ name: 'gray-200', hex: '#e5e7eb' },
	{ name: 'gray-300', hex: '#d1d5db' },
	{ name: 'gray-400', hex: '#9ca3af' },
	{ name: 'gray-500', hex: '#6b7280' },
	{ name: 'gray-600', hex: '#4b5563' },
	{ name: 'gray-700', hex: '#374151' },
	{ name: 'gray-800', hex: '#1f2937' },
	{ name: 'gray-900', hex: '#111827' },
	{ name: 'gray-950', hex: '#030712' },
	// Zinc
	{ name: 'zinc-50', hex: '#fafafa' },
	{ name: 'zinc-100', hex: '#f4f4f5' },
	{ name: 'zinc-200', hex: '#e4e4e7' },
	{ name: 'zinc-300', hex: '#d4d4d8' },
	{ name: 'zinc-400', hex: '#a1a1aa' },
	{ name: 'zinc-500', hex: '#71717a' },
	{ name: 'zinc-600', hex: '#52525b' },
	{ name: 'zinc-700', hex: '#3f3f46' },
	{ name: 'zinc-800', hex: '#27272a' },
	{ name: 'zinc-900', hex: '#18181b' },
	{ name: 'zinc-950', hex: '#09090b' },
	// Neutral
	{ name: 'neutral-50', hex: '#fafafa' },
	{ name: 'neutral-100', hex: '#f5f5f5' },
	{ name: 'neutral-200', hex: '#e5e5e5' },
	{ name: 'neutral-300', hex: '#d4d4d4' },
	{ name: 'neutral-400', hex: '#a3a3a3' },
	{ name: 'neutral-500', hex: '#737373' },
	{ name: 'neutral-600', hex: '#525252' },
	{ name: 'neutral-700', hex: '#404040' },
	{ name: 'neutral-800', hex: '#262626' },
	{ name: 'neutral-900', hex: '#171717' },
	{ name: 'neutral-950', hex: '#0a0a0a' },
	// Stone
	{ name: 'stone-50', hex: '#fafaf9' },
	{ name: 'stone-100', hex: '#f5f5f4' },
	{ name: 'stone-200', hex: '#e7e5e4' },
	{ name: 'stone-300', hex: '#d6d3d1' },
	{ name: 'stone-400', hex: '#a8a29e' },
	{ name: 'stone-500', hex: '#78716c' },
	{ name: 'stone-600', hex: '#57534e' },
	{ name: 'stone-700', hex: '#44403c' },
	{ name: 'stone-800', hex: '#292524' },
	{ name: 'stone-900', hex: '#1c1917' },
	{ name: 'stone-950', hex: '#0c0a09' },
	// Red
	{ name: 'red-50', hex: '#fef2f2' },
	{ name: 'red-100', hex: '#fee2e2' },
	{ name: 'red-200', hex: '#fecaca' },
	{ name: 'red-300', hex: '#fca5a5' },
	{ name: 'red-400', hex: '#f87171' },
	{ name: 'red-500', hex: '#ef4444' },
	{ name: 'red-600', hex: '#dc2626' },
	{ name: 'red-700', hex: '#b91c1c' },
	{ name: 'red-800', hex: '#991b1b' },
	{ name: 'red-900', hex: '#7f1d1d' },
	{ name: 'red-950', hex: '#450a0a' },
	// Orange
	{ name: 'orange-50', hex: '#fff7ed' },
	{ name: 'orange-100', hex: '#ffedd5' },
	{ name: 'orange-200', hex: '#fed7aa' },
	{ name: 'orange-300', hex: '#fdba74' },
	{ name: 'orange-400', hex: '#fb923c' },
	{ name: 'orange-500', hex: '#f97316' },
	{ name: 'orange-600', hex: '#ea580c' },
	{ name: 'orange-700', hex: '#c2410c' },
	{ name: 'orange-800', hex: '#9a3412' },
	{ name: 'orange-900', hex: '#7c2d12' },
	{ name: 'orange-950', hex: '#431407' },
	// Amber
	{ name: 'amber-50', hex: '#fffbeb' },
	{ name: 'amber-100', hex: '#fef3c7' },
	{ name: 'amber-200', hex: '#fde68a' },
	{ name: 'amber-300', hex: '#fcd34d' },
	{ name: 'amber-400', hex: '#fbbf24' },
	{ name: 'amber-500', hex: '#f59e0b' },
	{ name: 'amber-600', hex: '#d97706' },
	{ name: 'amber-700', hex: '#b45309' },
	{ name: 'amber-800', hex: '#92400e' },
	{ name: 'amber-900', hex: '#78350f' },
	{ name: 'amber-950', hex: '#451a03' },
	// Yellow
	{ name: 'yellow-50', hex: '#fefce8' },
	{ name: 'yellow-100', hex: '#fef9c3' },
	{ name: 'yellow-200', hex: '#fef08a' },
	{ name: 'yellow-300', hex: '#fde047' },
	{ name: 'yellow-400', hex: '#facc15' },
	{ name: 'yellow-500', hex: '#eab308' },
	{ name: 'yellow-600', hex: '#ca8a04' },
	{ name: 'yellow-700', hex: '#a16207' },
	{ name: 'yellow-800', hex: '#854d0e' },
	{ name: 'yellow-900', hex: '#713f12' },
	{ name: 'yellow-950', hex: '#422006' },
	// Lime
	{ name: 'lime-50', hex: '#f7fee7' },
	{ name: 'lime-100', hex: '#ecfccb' },
	{ name: 'lime-200', hex: '#d9f99d' },
	{ name: 'lime-300', hex: '#bef264' },
	{ name: 'lime-400', hex: '#a3e635' },
	{ name: 'lime-500', hex: '#84cc16' },
	{ name: 'lime-600', hex: '#65a30d' },
	{ name: 'lime-700', hex: '#4d7c0f' },
	{ name: 'lime-800', hex: '#3f6212' },
	{ name: 'lime-900', hex: '#365314' },
	{ name: 'lime-950', hex: '#1a2e05' },
	// Green
	{ name: 'green-50', hex: '#f0fdf4' },
	{ name: 'green-100', hex: '#dcfce7' },
	{ name: 'green-200', hex: '#bbf7d0' },
	{ name: 'green-300', hex: '#86efac' },
	{ name: 'green-400', hex: '#4ade80' },
	{ name: 'green-500', hex: '#22c55e' },
	{ name: 'green-600', hex: '#16a34a' },
	{ name: 'green-700', hex: '#15803d' },
	{ name: 'green-800', hex: '#166534' },
	{ name: 'green-900', hex: '#14532d' },
	{ name: 'green-950', hex: '#052e16' },
	// Emerald
	{ name: 'emerald-50', hex: '#ecfdf5' },
	{ name: 'emerald-100', hex: '#d1fae5' },
	{ name: 'emerald-200', hex: '#a7f3d0' },
	{ name: 'emerald-300', hex: '#6ee7b7' },
	{ name: 'emerald-400', hex: '#34d399' },
	{ name: 'emerald-500', hex: '#10b981' },
	{ name: 'emerald-600', hex: '#059669' },
	{ name: 'emerald-700', hex: '#047857' },
	{ name: 'emerald-800', hex: '#065f46' },
	{ name: 'emerald-900', hex: '#064e3b' },
	{ name: 'emerald-950', hex: '#022c22' },
	// Teal
	{ name: 'teal-50', hex: '#f0fdfa' },
	{ name: 'teal-100', hex: '#ccfbf1' },
	{ name: 'teal-200', hex: '#99f6e4' },
	{ name: 'teal-300', hex: '#5eead4' },
	{ name: 'teal-400', hex: '#2dd4bf' },
	{ name: 'teal-500', hex: '#14b8a6' },
	{ name: 'teal-600', hex: '#0d9488' },
	{ name: 'teal-700', hex: '#0f766e' },
	{ name: 'teal-800', hex: '#115e59' },
	{ name: 'teal-900', hex: '#134e4a' },
	{ name: 'teal-950', hex: '#042f2e' },
	// Cyan
	{ name: 'cyan-50', hex: '#ecfeff' },
	{ name: 'cyan-100', hex: '#cffafe' },
	{ name: 'cyan-200', hex: '#a5f3fc' },
	{ name: 'cyan-300', hex: '#67e8f9' },
	{ name: 'cyan-400', hex: '#22d3ee' },
	{ name: 'cyan-500', hex: '#06b6d4' },
	{ name: 'cyan-600', hex: '#0891b2' },
	{ name: 'cyan-700', hex: '#0e7490' },
	{ name: 'cyan-800', hex: '#155e75' },
	{ name: 'cyan-900', hex: '#164e63' },
	{ name: 'cyan-950', hex: '#083344' },
	// Sky
	{ name: 'sky-50', hex: '#f0f9ff' },
	{ name: 'sky-100', hex: '#e0f2fe' },
	{ name: 'sky-200', hex: '#bae6fd' },
	{ name: 'sky-300', hex: '#7dd3fc' },
	{ name: 'sky-400', hex: '#38bdf8' },
	{ name: 'sky-500', hex: '#0ea5e9' },
	{ name: 'sky-600', hex: '#0284c7' },
	{ name: 'sky-700', hex: '#0369a1' },
	{ name: 'sky-800', hex: '#075985' },
	{ name: 'sky-900', hex: '#0c4a6e' },
	{ name: 'sky-950', hex: '#082f49' },
	// Blue
	{ name: 'blue-50', hex: '#eff6ff' },
	{ name: 'blue-100', hex: '#dbeafe' },
	{ name: 'blue-200', hex: '#bfdbfe' },
	{ name: 'blue-300', hex: '#93c5fd' },
	{ name: 'blue-400', hex: '#60a5fa' },
	{ name: 'blue-500', hex: '#3b82f6' },
	{ name: 'blue-600', hex: '#2563eb' },
	{ name: 'blue-700', hex: '#1d4ed8' },
	{ name: 'blue-800', hex: '#1e40af' },
	{ name: 'blue-900', hex: '#1e3a8a' },
	{ name: 'blue-950', hex: '#172554' },
	// Indigo
	{ name: 'indigo-50', hex: '#eef2ff' },
	{ name: 'indigo-100', hex: '#e0e7ff' },
	{ name: 'indigo-200', hex: '#c7d2fe' },
	{ name: 'indigo-300', hex: '#a5b4fc' },
	{ name: 'indigo-400', hex: '#818cf8' },
	{ name: 'indigo-500', hex: '#6366f1' },
	{ name: 'indigo-600', hex: '#4f46e5' },
	{ name: 'indigo-700', hex: '#4338ca' },
	{ name: 'indigo-800', hex: '#3730a3' },
	{ name: 'indigo-900', hex: '#312e81' },
	{ name: 'indigo-950', hex: '#1e1b4b' },
	// Violet
	{ name: 'violet-50', hex: '#f5f3ff' },
	{ name: 'violet-100', hex: '#ede9fe' },
	{ name: 'violet-200', hex: '#ddd6fe' },
	{ name: 'violet-300', hex: '#c4b5fd' },
	{ name: 'violet-400', hex: '#a78bfa' },
	{ name: 'violet-500', hex: '#8b5cf6' },
	{ name: 'violet-600', hex: '#7c3aed' },
	{ name: 'violet-700', hex: '#6d28d9' },
	{ name: 'violet-800', hex: '#5b21b6' },
	{ name: 'violet-900', hex: '#4c1d95' },
	{ name: 'violet-950', hex: '#2e1065' },
	// Purple
	{ name: 'purple-50', hex: '#faf5ff' },
	{ name: 'purple-100', hex: '#f3e8ff' },
	{ name: 'purple-200', hex: '#e9d5ff' },
	{ name: 'purple-300', hex: '#d8b4fe' },
	{ name: 'purple-400', hex: '#c084fc' },
	{ name: 'purple-500', hex: '#a855f7' },
	{ name: 'purple-600', hex: '#9333ea' },
	{ name: 'purple-700', hex: '#7e22ce' },
	{ name: 'purple-800', hex: '#6b21a8' },
	{ name: 'purple-900', hex: '#581c87' },
	{ name: 'purple-950', hex: '#3b0764' },
	// Fuchsia
	{ name: 'fuchsia-50', hex: '#fdf4ff' },
	{ name: 'fuchsia-100', hex: '#fae8ff' },
	{ name: 'fuchsia-200', hex: '#f5d0fe' },
	{ name: 'fuchsia-300', hex: '#f0abfc' },
	{ name: 'fuchsia-400', hex: '#e879f9' },
	{ name: 'fuchsia-500', hex: '#d946ef' },
	{ name: 'fuchsia-600', hex: '#c026d3' },
	{ name: 'fuchsia-700', hex: '#a21caf' },
	{ name: 'fuchsia-800', hex: '#86198f' },
	{ name: 'fuchsia-900', hex: '#701a75' },
	{ name: 'fuchsia-950', hex: '#4a044e' },
	// Pink
	{ name: 'pink-50', hex: '#fdf2f8' },
	{ name: 'pink-100', hex: '#fce7f3' },
	{ name: 'pink-200', hex: '#fbcfe8' },
	{ name: 'pink-300', hex: '#f9a8d4' },
	{ name: 'pink-400', hex: '#f472b6' },
	{ name: 'pink-500', hex: '#ec4899' },
	{ name: 'pink-600', hex: '#db2777' },
	{ name: 'pink-700', hex: '#be185d' },
	{ name: 'pink-800', hex: '#9d174d' },
	{ name: 'pink-900', hex: '#831843' },
	{ name: 'pink-950', hex: '#500724' },
	// Rose
	{ name: 'rose-50', hex: '#fff1f2' },
	{ name: 'rose-100', hex: '#ffe4e6' },
	{ name: 'rose-200', hex: '#fecdd3' },
	{ name: 'rose-300', hex: '#fda4af' },
	{ name: 'rose-400', hex: '#fb7185' },
	{ name: 'rose-500', hex: '#f43f5e' },
	{ name: 'rose-600', hex: '#e11d48' },
	{ name: 'rose-700', hex: '#be123c' },
	{ name: 'rose-800', hex: '#9f1239' },
	{ name: 'rose-900', hex: '#881337' },
	{ name: 'rose-950', hex: '#4c0519' },
	// White and Black
	{ name: 'white', hex: '#ffffff' },
	{ name: 'black', hex: '#000000' }
];

// Convert hex to RGB
export function hexToRgb(hex) {
	const bigint = parseInt(hex.substring(1), 16);
	const r = (bigint >> 16) & 255;
	const g = (bigint >> 8) & 255;
	const b = bigint & 255;
	return [r, g, b];
}

// RGB Distance (simple matching)
export function rgbDistance(hex1, hex2) {
	const rgb1 = hexToRgb(hex1);
	const rgb2 = hexToRgb(hex2);
	return Math.sqrt(
		Math.pow(rgb2[0] - rgb1[0], 2) + Math.pow(rgb2[1] - rgb1[1], 2) + Math.pow(rgb2[2] - rgb1[2], 2)
	);
}

// Convert RGB to XYZ
export function rgbToXyz(rgb) {
	let [r, g, b] = rgb.map((val) => {
		val = val / 255;
		return val > 0.04045 ? Math.pow((val + 0.055) / 1.055, 2.4) : val / 12.92;
	});

	r *= 100;
	g *= 100;
	b *= 100;

	const x = r * 0.4124564 + g * 0.3575761 + b * 0.1804375;
	const y = r * 0.2126729 + g * 0.7151522 + b * 0.072175;
	const z = r * 0.0193339 + g * 0.119192 + b * 0.9503041;

	return [x, y, z];
}

// Convert XYZ to LAB
export function xyzToLab(xyz) {
	let [x, y, z] = xyz;
	x = x / 95.047;
	y = y / 100;
	z = z / 108.883;

	[x, y, z] = [x, y, z].map((val) => {
		return val > 0.008856 ? Math.pow(val, 1 / 3) : 7.787 * val + 16 / 116;
	});

	const l = 116 * y - 16;
	const a = 500 * (x - y);
	const b = 200 * (y - z);

	return [l, a, b];
}

// Convert hex to LAB
export function hexToLab(hex) {
	const rgb = hexToRgb(hex);
	const xyz = rgbToXyz(rgb);
	return xyzToLab(xyz);
}

export function HSLToHex(h, s, l) {
	s /= 100;
	l /= 100;

	const c = (1 - Math.abs(2 * l - 1)) * s;
	const x = c * (1 - Math.abs(((h / 60) % 2) - 1));
	const m = l - c / 2;
	let r = 0,
		g = 0,
		b = 0;

	if (0 <= h && h < 60) {
		r = c;
		g = x;
		b = 0;
	} else if (60 <= h && h < 120) {
		r = x;
		g = c;
		b = 0;
	} else if (120 <= h && h < 180) {
		r = 0;
		g = c;
		b = x;
	} else if (180 <= h && h < 240) {
		r = 0;
		g = x;
		b = c;
	} else if (240 <= h && h < 300) {
		r = x;
		g = 0;
		b = c;
	} else if (300 <= h && h < 360) {
		r = c;
		g = 0;
		b = x;
	}

	r = Math.round((r + m) * 255)
		.toString(16)
		.padStart(2, '0');
	g = Math.round((g + m) * 255)
		.toString(16)
		.padStart(2, '0');
	b = Math.round((b + m) * 255)
		.toString(16)
		.padStart(2, '0');

	return `#${r}${g}${b}`.toUpperCase();
}

// Calculate delta E (color difference) using CIE94 formula
export function deltaE94(lab1, lab2) {
	const [L1, a1, b1] = lab1;
	const [L2, a2, b2] = lab2;

	const dL = L1 - L2;
	const da = a1 - a2;
	const db = b1 - b2;

	const C1 = Math.sqrt(a1 * a1 + b1 * b1);
	const C2 = Math.sqrt(a2 * a2 + b2 * b2);
	const dC = C1 - C2;

	const dH = Math.sqrt(Math.max(0, da * da + db * db - dC * dC));

	const sL = 1;
	const sC = 1 + 0.045 * C1;
	const sH = 1 + 0.015 * C1;

	const dL2 = Math.pow(dL / sL, 2);
	const dC2 = Math.pow(dC / sC, 2);
	const dH2 = Math.pow(dH / sH, 2);

	return Math.sqrt(dL2 + dC2 + dH2);
}

export function findNearestTailwindColor(hex, method = 'lab') {
	if (method === 'rgb') {
		return tailwindColors
			.map((color) => ({
				...color,
				distance: rgbDistance(hex, color.hex)
			}))
			.sort((a, b) => a.distance - b.distance)[0];
	}

	// Default LAB method (most accurate)
	const inputLab = hexToLab(hex);
	return tailwindColors
		.map((color) => ({
			...color,
			distance: deltaE94(inputLab, hexToLab(color.hex))
		}))
		.sort((a, b) => a.distance - b.distance)[0];
}

export function hexToHsl(hex) {
	let [r, g, b] = hexToRgb(hex);
	r /= 255;
	g /= 255;
	b /= 255;

	const max = Math.max(r, g, b);
	const min = Math.min(r, g, b);
	let h,
		s,
		l = (max + min) / 2;

	if (max === min) {
		h = s = 0;
	} else {
		const d = max - min;
		s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
		switch (max) {
			case r:
				h = (g - b) / d + (g < b ? 6 : 0);
				break;
			case g:
				h = (b - r) / d + 2;
				break;
			case b:
				h = (r - g) / d + 4;
				break;
		}
		h /= 6;
	}

	return [h * 360, s * 100, l * 100];
}

export function hexToOklch(hex) {
	// Convert hex to RGB
	const rgb = hexToRgb(hex);

	// Convert RGB (0-255) to linear RGB (0-1)
	const linearRGB = rgb.map((val) => {
		const srgb = val / 255;
		return srgb <= 0.04045 ? srgb / 12.92 : Math.pow((srgb + 0.055) / 1.055, 2.4);
	});

	// Convert to LMS
	const [lr, mg, sb] = linearRGB;
	const l = 0.4122214708 * lr + 0.5363325363 * mg + 0.0514459929 * sb;
	const m = 0.2119034982 * lr + 0.6806995451 * mg + 0.1073969566 * sb;
	const s = 0.0883024619 * lr + 0.2817188376 * mg + 0.6299787005 * sb;

	// Convert LMS to Lab-ish
	const l_ = Math.cbrt(Math.max(l, 0));
	const m_ = Math.cbrt(Math.max(m, 0));
	const s_ = Math.cbrt(Math.max(s, 0));

	// Convert to OKLab
	const L = 0.2104542553 * l_ + 0.793617785 * m_ - 0.0040720468 * s_;
	const a = 1.9779984951 * l_ - 2.428592205 * m_ + 0.4505937099 * s_;
	const b = 0.0259040371 * l_ + 0.7827717662 * m_ - 0.808675766 * s_;

	// Convert OKLab to OKLCH
	const C = Math.sqrt(a * a + b * b);
	const H = Math.atan2(b, a);

	// Format values
	const L_percent = Math.round(L * 100);
	const C_val = C.toFixed(3);
	const H_val = (H / (2 * Math.PI) + 1) % 1;

	return `oklch(${L_percent}% ${C_val} ${H_val.toFixed(3)})`;
}

export function getRandomHexColor() {
	const letters = '0123456789abcdef';
	let color = '#';
	for (let i = 0; i < 6; i++) {
		color += letters[Math.floor(Math.random() * 16)];
	}
	return color;
}

export function luminance(r, g, b) {
	let [rs, gs, bs] = [r, g, b].map((c) => {
		c = c / 255;
		return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
	});
	return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
}

export function getContrastRatio(hex1, hex2) {
	const rgb1 = hexToRgb(hex1);
	const rgb2 = hexToRgb(hex2);
	const l1 = luminance(rgb1[0], rgb1[1], rgb1[2]);
	const l2 = luminance(rgb2[0], rgb2[1], rgb2[2]);
	const lightest = Math.max(l1, l2);
	const darkest = Math.min(l1, l2);
	return (lightest + 0.05) / (darkest + 0.05);
}

export function describeColor(hex) {
	try {
		const hsl = hexToHsl(hex);
		const [h, s, l] = hsl;

		// Special cases first
		if (l === 0) return 'This is black (0% lightness)';
		if (l === 100) return 'This is white (100% lightness)';

		// New check for very low saturation - treat as gray but mention undertone
		if (s < 10) {
			// Increased from 1 to 10 for better gray detection
			const undertone = getHueDescription(h);
			return `This is a ${getLightnessDesc(l)} gray with a slight ${undertone} undertone`;
		}

		function getPerceivedSaturation(sat, light) {
			if (light < 10) return sat * 0.3;
			if (light > 90) return sat * 0.4;
			if (light < 20 || light > 80) return sat * 0.6;
			if (light < 30 || light > 70) return sat * 0.8;
			return sat;
		}

		function getSaturationDesc(sat, light) {
			const perceivedSat = getPerceivedSaturation(sat, light);
			if (perceivedSat < 5) return 'neutral';
			if (perceivedSat < 15) return 'subtle';
			if (perceivedSat < 35) return 'muted';
			if (perceivedSat < 65) return 'rich';
			if (perceivedSat < 85) return 'vibrant';
			return 'vivid';
		}

		// Move these function definitions outside the main function
		function getLightnessDesc(light) {
			if (light < 5) return 'nearly black';
			if (light < 15) return 'very dark';
			if (light < 35) return 'dark';
			if (light > 95) return 'nearly white';
			if (light > 85) return 'very light';
			if (light > 65) return 'light';
			if (light < 45) return 'deep';
			return 'medium';
		}

		function getHueDescription(hue) {
			const normalizedHue = ((hue % 360) + 360) % 360;
			const hueRanges = [
				{ range: [355, 360], name: 'red' },
				{ range: [0, 10], name: 'red' },
				{ range: [10, 20], name: 'scarlet' },
				{ range: [20, 30], name: 'orange-red' },
				{ range: [30, 40], name: 'orange' },
				{ range: [40, 50], name: 'golden-orange' },
				{ range: [50, 60], name: 'golden-yellow' },
				{ range: [60, 70], name: 'yellow' },
				{ range: [70, 80], name: 'chartreuse' },
				{ range: [80, 90], name: 'yellow-green' },
				{ range: [90, 110], name: 'lime' },
				{ range: [110, 130], name: 'green' },
				{ range: [130, 150], name: 'forest' },
				{ range: [150, 170], name: 'emerald' },
				{ range: [170, 180], name: 'mint' },
				{ range: [180, 190], name: 'teal' },
				{ range: [190, 200], name: 'turquoise' },
				{ range: [200, 220], name: 'aqua' },
				{ range: [220, 240], name: 'sky blue' },
				{ range: [240, 250], name: 'blue' },
				{ range: [250, 260], name: 'royal blue' },
				{ range: [260, 270], name: 'indigo' },
				{ range: [270, 280], name: 'violet' },
				{ range: [280, 290], name: 'purple' },
				{ range: [290, 300], name: 'plum' },
				{ range: [300, 310], name: 'magenta' },
				{ range: [310, 325], name: 'hot pink' },
				{ range: [325, 340], name: 'pink' },
				{ range: [340, 355], name: 'rose' }
			];

			const matchedColor = hueRanges.find(
				(range) => range.range[0] <= normalizedHue && normalizedHue <= range.range[1]
			);
			return matchedColor?.name ?? 'gray';
		}

		function shouldIncludeSaturation(s, l) {
			const perceivedSat = getPerceivedSaturation(s, l);
			return perceivedSat > 15 && l > 10 && l < 90;
		}

		const primaryHue = getHueDescription(h);
		const satDescription = getSaturationDesc(s, l);
		const lightDescription = getLightnessDesc(l);

		if (shouldIncludeSaturation(s, l)) {
			return `This is a ${lightDescription}, ${satDescription} ${primaryHue}`;
		} else {
			return `This is a ${lightDescription} ${primaryHue}`;
		}
	} catch (err) {
		// console.error('Error in describeColor:', err);
		return 'Color description unavailable';
	}
}

export const defaultColorInfo = {
	meaning:
		'A balanced mid-tone color that can be used for various UI elements while maintaining good contrast and visual appeal',
	usage: {
		ui: [
			'Interactive elements like buttons and links',
			'Secondary interface elements',
			'Visual indicators and status markers',
			'Decorative accents and highlights',
			'Background elements and containers'
		],
		bestPractices:
			'Consider the context and hierarchy of your interface when using this color. Test contrast ratios in both light and dark modes',
		combinations: [
			'Pair with neutrals for a balanced look',
			'Use lighter or darker shades within the same family for depth',
			'Consider complementary colors for emphasis',
			'Mix with grays for professional interfaces'
		]
	},
	accessibility: {
		textGuidelines: 'Check WCAG contrast requirements - 4.5:1 for normal text, 3:1 for large text',
		uiConsiderations: 'Ensure interactive elements are clearly distinguishable',
		colorBlindness: 'Test with common color vision deficiencies',
		wcag: {
			normalText: '4.5:1 minimum contrast ratio',
			largeText: '3:1 minimum contrast ratio',
			uiComponents: '3:1 minimum contrast ratio'
		}
	}
};

export const colorEnrichment = {
	slate: {
		meaning: 'Professional, neutral, sophisticated',
		usage: {
			ui: ['Backgrounds', 'Text', 'Borders'],
			bestPractices: 'Excellent for body text and UI elements that need to maintain neutrality',
			combinations: [
				'Pair with vibrant accent colors for contrast',
				'Works well with blues and teals'
			]
		},
		accessibility: {
			textGuidelines: 'Slate-900 on Slate-50 meets WCAG AAA requirements',
			uiConsiderations: 'Ensure sufficient contrast between adjacent shades'
		}
	},
	gray: {
		meaning: 'Balance, calmness, professionalism',
		usage: {
			ui: ['Backgrounds', 'Text', 'Subtle borders'],
			bestPractices: 'Perfect for text and UI elements requiring neutrality',
			combinations: ['Combines well with any accent color', 'Excellent with white space']
		},
		accessibility: {
			textGuidelines: 'Use darker shades (700+) for text on light backgrounds',
			uiConsiderations: 'Maintain sufficient contrast between adjacent gray shades'
		}
	},
	blue: {
		meaning: 'Trust, stability, professionalism',
		usage: {
			ui: ['Primary actions', 'Links', 'Brand elements'],
			bestPractices: 'Use darker shades for text, lighter shades for backgrounds',
			combinations: ['Pair with orange for striking CTAs', 'Works well with grays and whites']
		},
		accessibility: {
			textGuidelines: 'Blue-700 and darker meet WCAG AA on white backgrounds',
			uiConsiderations: 'Avoid blue text on red backgrounds'
		}
	},
	yellow: {
		meaning:
			'Optimistic, energetic, and attention-grabbing. Yellow symbolizes warmth, caution, and positivity',
		usage: {
			ui: [
				'Warning messages (softer than red)',
				'Highlighting important content',
				'Review or pending states',
				'Rating elements',
				'Attention-grabbing accents'
			],
			bestPractices:
				'Use sparingly for maximum impact. Ensure sufficient contrast, especially with white backgrounds',
			combinations: [
				'Pair with dark grays for readability',
				'Use with purple for high contrast',
				'Combine with blue for a professional look',
				'Works well with earth tones'
			]
		},
		accessibility: {
			textGuidelines:
				'Avoid using yellow for text except in very dark shades. Yellow-900 minimum for text on light backgrounds',
			uiConsiderations: 'Consider color blindness implications. Always pair with clear iconography',
			colorBlindness:
				'May be difficult to distinguish for some color-blind users. Use with additional visual cues'
		},
		technical: {
			gamut: 'May appear differently across devices due to wide gamut variations',
			implementation: 'Consider dark mode inversions carefully',
			displayConsiderations: 'Test on multiple screens for consistent visibility'
		}
	},

	purple: {
		meaning: 'Creative, luxurious, and mysterious. Purple suggests innovation and premium quality',
		usage: {
			ui: [
				'Premium features',
				'Creative tools',
				'Alternative primary actions',
				'Active states',
				'Featured content'
			],
			bestPractices:
				'Use for premium or creative features. Works well for highlighting special content',
			combinations: [
				'Excellent with gold for luxury themes',
				'Pair with teal for creative applications',
				'Use with gray for professional balance',
				'Combine with pink for playful interfaces'
			]
		},
		accessibility: {
			textGuidelines:
				'Use purple-800 or darker for text. Ensure sufficient contrast with backgrounds',
			uiConsiderations:
				'Test with both light and dark modes. Consider color blindness implications',
			colorBlindness:
				'May appear similar to blue for some users. Include additional visual differentiation'
		},
		technical: {
			gamut: 'Wide variation across different screens',
			implementation: 'Consider using with complementary yellows for maximum impact',
			displayConsiderations: 'May require adjustment in dark mode'
		}
	},

	orange: {
		meaning:
			'Energetic, friendly, and confident. Orange combines the energy of red with the cheerfulness of yellow',
		usage: {
			ui: [
				'Call-to-action buttons',
				'Promotional content',
				'Beta features',
				'Social sharing',
				'Entertainment elements'
			],
			bestPractices:
				'Use for drawing attention without the urgency of red. Effective for calls-to-action',
			combinations: [
				'Pair with blue for high contrast CTAs',
				'Use with neutral grays for balance',
				'Combine with green for nature themes',
				'Works well with dark blues'
			]
		},
		accessibility: {
			textGuidelines: 'Use orange-800 or darker for text. Test carefully on colored backgrounds',
			uiConsiderations: 'Ensure sufficient contrast for interactive elements',
			colorBlindness: 'May appear muted to some users. Include clear hover/focus states'
		},
		technical: {
			gamut: 'Generally consistent across devices',
			implementation: 'Effective for gradient implementations',
			displayConsiderations: 'Test saturation levels across devices'
		}
	},

	pink: {
		meaning: 'Playful, feminine, and modern. Pink suggests creativity and youthful energy',
		usage: {
			ui: [
				'Accent colors',
				'Brand elements',
				'Featured content',
				'Social media themes',
				'Creative applications'
			],
			bestPractices:
				'Use for standing out in modern interfaces. Effective for brands targeting younger audiences',
			combinations: [
				'Pair with navy for sophistication',
				'Use with gray for modern look',
				'Combine with purple for creative themes',
				'Works well with mint green'
			]
		},
		accessibility: {
			textGuidelines: 'Use pink-700 or darker for text. Ensure readability on light backgrounds',
			uiConsiderations: 'Test in both light and dark modes. Consider color blindness',
			colorBlindness: 'May appear grayish to some users. Include clear visual indicators'
		},
		technical: {
			gamut: 'Can be vibrant across modern displays',
			implementation: 'Consider using for gradient endings',
			displayConsiderations: 'May need adjustment for print materials'
		}
	}
};

export const technicalColorInfo = {
	50: {
		usage: 'Subtle backgrounds, hover states for light themes',
		contrast: 'Usually requires very dark text (800-900)',
		darkMode: 'Often inverted to 900 shade',
		accessibility: 'Rarely suitable for text, excellent for subtle backgrounds'
	},
	100: {
		usage: 'Page backgrounds, card highlights',
		contrast: 'Requires dark text (700-900)',
		darkMode: 'Often inverted to 800 shade',
		accessibility: 'Good for large background areas, poor for text'
	},
	200: {
		usage: 'Selected items in light themes, subtle borders',
		contrast: 'Requires dark text (600-900)',
		darkMode: 'Often inverted to 700 shade',
		accessibility: 'Suitable for decorative elements, not for text'
	},
	300: {
		usage: 'Soft UI elements, secondary backgrounds',
		contrast: 'Requires dark text (500-900)',
		darkMode: 'Often inverted to 600 shade',
		accessibility: 'Good for UI elements, poor for text contrast'
	},
	400: {
		usage: 'Disabled buttons, secondary text in dark themes',
		contrast: 'Requires dark text (700-900) for accessibility',
		darkMode: 'Often inverted to 500 shade',
		accessibility: 'Usually not suitable for primary text'
	},
	500: {
		usage: 'Primary brand colors, button backgrounds',
		contrast: 'Versatile, works with white or very dark text',
		darkMode: 'Often used as-is',
		accessibility: 'Test contrast carefully for text usage'
	},
	600: {
		usage: 'Primary button hover states, text on light backgrounds',
		contrast: 'Good with white text',
		darkMode: 'Often lightened to 400 shade',
		accessibility: 'Generally good for larger text on light backgrounds'
	},
	700: {
		usage: 'Primary text, interactive elements',
		contrast: 'Excellent with white text',
		darkMode: 'Often lightened to 300 shade',
		accessibility: 'Usually meets WCAG AA standards for text on light backgrounds'
	},
	800: {
		usage: 'Heavy text, high-contrast elements',
		contrast: 'Best with white text',
		darkMode: 'Often lightened to 200 shade',
		accessibility: 'Meets WCAG AAA standards for text on light backgrounds'
	},
	900: {
		usage: 'Darkest variant, text colors',
		contrast: 'Highest contrast with white',
		darkMode: 'Often lightened to 100 shade',
		accessibility: 'Excellent for text on light backgrounds'
	}
};

export const colorUseCases = {
	'blue-500': {
		webExamples: [
			"Facebook's primary brand color",
			"Twitter's action buttons",
			"LinkedIn's interactive elements",
			"PayPal's trust indicators"
		],
		commonUses: [
			'Primary buttons',
			'Links',
			'Brand accents',
			'Navigation elements',
			'Trust indicators'
		],
		industries: ['Tech', 'Finance', 'Healthcare', 'Corporate', 'Education']
	},
	'green-500': {
		webExamples: [
			"Spotify's brand color",
			"WhatsApp's theme",
			"Evernote's logo",
			"TechCrunch's brand accent"
		],
		commonUses: [
			'Success states',
			'Environmental themes',
			'Financial indicators',
			'Progress bars',
			'Confirmation messages'
		],
		industries: ['Environment', 'Finance', 'Health', 'Education', 'Agriculture']
	},
	'red-500': {
		webExamples: [
			"Netflix's brand color",
			"YouTube's play button",
			"Pinterest's primary color",
			"Target's brand identity"
		],
		commonUses: [
			'Error states',
			'Delete actions',
			'Urgent notifications',
			'Sale badges',
			'Important alerts'
		],
		industries: ['Entertainment', 'Retail', 'Food & Beverage', 'Emergency Services']
	},
	'purple-500': {
		webExamples: [
			"Twitch's brand color",
			"Discord's theme",
			"Slack's accent color",
			"Yahoo's brand"
		],
		commonUses: [
			'Creative elements',
			'Premium features',
			'Innovation indicators',
			'Community sections'
		],
		industries: ['Creative', 'Gaming', 'Technology', 'Beauty', 'Entertainment']
	},
	'orange-500': {
		webExamples: ["Amazon's primary buttons", "SoundCloud's brand", "HubSpot's accent color"],
		commonUses: ['Call-to-action buttons', 'Warning states', 'Energy themes', 'Promotional badges'],
		industries: ['E-commerce', 'Food', 'Construction', 'Sports', 'Energy']
	},
	'yellow-500': {
		webExamples: ["Snapchat's brand color", "IMDb's logo", "National Geographic's border"],
		commonUses: ['Warning indicators', 'Review stars', 'Highlighting', 'Energy themes'],
		industries: ['Construction', 'Transportation', "Children's Products", 'Food Service']
	},
	'pink-500': {
		webExamples: ["Lyft's brand color", "Dribbble's theme", "T-Mobile's identity"],
		commonUses: ['Fashion elements', 'Social features', 'Youth themes', 'Creative accents'],
		industries: ['Fashion', 'Beauty', 'Social Media', 'Entertainment']
	},
	'indigo-500': {
		webExamples: ["Visa's brand elements", "IBM's corporate color", "Intel's logo color"],
		commonUses: ['Corporate elements', 'Professional interfaces', 'Technology themes'],
		industries: ['Banking', 'Corporate', 'Technology', 'Security']
	},
	'teal-500': {
		webExamples: ["Deliveroo's brand color", "MailChimp's accents", "Tumblr's theme options"],
		commonUses: ['Medical interfaces', 'Environmental themes', 'Clean design accents'],
		industries: ['Healthcare', 'Sustainability', 'Wellness', 'Ocean-related']
	},
	'gray-500': {
		webExamples: ["Apple's UI elements", "Medium's text color", "GitHub's interface"],
		commonUses: ['Text content', 'Neutral backgrounds', 'Disabled states', 'Interface elements'],
		industries: ['Technology', 'Publishing', 'Professional Services']
	},
	'rose-500': {
		webExamples: ["Airbnb's brand color", "Klarna's accent", "Dunkin' brand elements"],
		commonUses: ['Lifestyle features', 'Dating apps', 'Food-related content'],
		industries: ['Hospitality', 'Dating', 'Food & Beverage', 'Lifestyle']
	},
	'cyan-500': {
		webExamples: ["Vimeo's player controls", "Trello's brand elements", "Digital Ocean's theme"],
		commonUses: ['Tech interfaces', 'Water themes', 'Cool accents'],
		industries: ['Technology', 'Water Services', 'Science', 'Marine']
	}
};

function getShadeDescription(colorName) {
	const [family, shade] = colorName.split('-');

	// Shade-specific descriptions
	const shadeDescriptions = {
		50: `The lightest, most delicate shade of ${family}, perfect for subtle backgrounds and soft highlights`,
		100: `A very light ${family} tone, ideal for page backgrounds and gentle contrasts`,
		200: `A soft ${family} shade that works well for secondary elements and hover states`,
		300: `A light ${family} tone that balances visibility with subtlety`,
		400: `A medium-light ${family} shade, useful for secondary elements and soft accents`,
		500: `A balanced, vibrant ${family} that serves as a primary accent color`,
		600: `A rich ${family} tone that provides strong emphasis without overwhelming`,
		700: `A deep, bold ${family} shade excellent for text and primary actions`,
		800: `An intense ${family} tone that commands attention and ensures readability`,
		900: `The deepest, most powerful ${family} shade, perfect for high-contrast elements`,
		950: `The darkest ${family} variation, offering maximum contrast and impact`
	};

	return shadeDescriptions[shade] || defaultColorInfo.meaning;
}

export function getColorInfo(colorName, colorHex) {
	if (!colorName) return defaultColorInfo;

	const family = colorName.split('-')[0];
	const shade = colorName.split('-')[1];

	const baseInfo = colorEnrichment[family] || defaultColorInfo;
	const specificInfo = colorUseCases[colorName] || {};
	const technicalInfo = technicalColorInfo[shade] || {};

	// Remove the problematic functions that were causing the 500 error
	return {
		...defaultColorInfo,
		...baseInfo,
		...specificInfo,
		meaning: getShadeDescription(colorName), // Use dynamic description
		technical: {
			...baseInfo.technical,
			...technicalInfo
		},
		// Add color combinations directly here instead of using undefined colorCombinations function
		combinations: {
			monochromatic: generateMonochromaticColors(colorHex),
			complementary: generateComplementaryColors(colorHex),
			analogous: generateAnalogousColors(colorHex),
			triadic: generateTriadicColors(colorHex)
		}
	};
}

export function generateMonochromaticColors(baseColor, count = 5) {
	const hsl = hexToHsl(baseColor);
	const step = 100 / (count + 1);
	return Array.from({ length: count }, (_, i) => {
		const lightness = Math.min(90, Math.max(10, step * (i + 1)));
		return HSLToHex(hsl[0], hsl[1], lightness);
	});
}

export function generateComplementaryColors(baseColor) {
	const hsl = hexToHsl(baseColor);
	const complementaryHue = (hsl[0] + 180) % 360;
	return [baseColor, HSLToHex(complementaryHue, hsl[1], hsl[2])];
}

export function generateAnalogousColors(baseColor) {
	const hsl = hexToHsl(baseColor);
	return [
		HSLToHex((hsl[0] - 30 + 360) % 360, hsl[1], hsl[2]),
		baseColor,
		HSLToHex((hsl[0] + 30) % 360, hsl[1], hsl[2])
	];
}

export function generateTriadicColors(baseColor) {
	const hsl = hexToHsl(baseColor);
	return [
		baseColor,
		HSLToHex((hsl[0] + 120) % 360, hsl[1], hsl[2]),
		HSLToHex((hsl[0] + 240) % 360, hsl[1], hsl[2])
	];
}

export function generateMonochromaticTailwindColors(baseColor, count = 5) {
	const colors = generateMonochromaticColors(baseColor, count);
	return colors.map((color) => findNearestTailwindColor(color));
}

export function generateComplementaryTailwindColors(baseColor) {
	const colors = generateComplementaryColors(baseColor);
	return colors.map((color) => findNearestTailwindColor(color));
}

export function generateAnalogousTailwindColors(baseColor) {
	const colors = generateAnalogousColors(baseColor);
	return colors.map((color) => findNearestTailwindColor(color));
}

export function generateTriadicTailwindColors(baseColor) {
	const colors = generateTriadicColors(baseColor);
	return colors.map((color) => findNearestTailwindColor(color));
}

// Helper function to find nearest Tailwind colors for combinations
export function findNearestTailwindColors(colors) {
	return colors.map((color) => ({
		color,
		nearest: findNearestTailwindColor(color)
	}));
}
